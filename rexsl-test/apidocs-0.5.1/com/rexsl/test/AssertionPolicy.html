<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_12-ea) on Wed Oct 16 12:19:50 CEST 2013 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>AssertionPolicy (rexsl-test 0.5.1 API)</title>
<meta name="date" content="2013-10-16">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AssertionPolicy (rexsl-test 0.5.1 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AssertionPolicy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../com/rexsl/test/AssertionPolicy.Quiet.html" title="annotation in com.rexsl.test"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/rexsl/test/AssertionPolicy.html" target="_top">Frames</a></li>
<li><a href="AssertionPolicy.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.rexsl.test</div>
<h2 title="Interface AssertionPolicy" class="title">Interface AssertionPolicy</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../com/rexsl/test/html/NoBrokenLinks.html" title="class in com.rexsl.test.html">NoBrokenLinks</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="strong">AssertionPolicy</span></pre>
<div class="block">Policy of assertion, used by <a href="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><code>TestResponse</code></a>.

 <p>Assertion policy is used in <a href="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><code>TestResponse</code></a> in order to validate
 REST response before further processing. Consider this example:

 <pre>
 String data = RestTester.start(new URI("http://example.com"))
   .assertThat(retryOnFailure)
   .assertXPath("//data")
   .xpath("//data/text()")
   .get(0);
 </pre>

 <p>This code will 1) retrieve the document from the provided
 <a href="http://docs.oracle.com/javase/6/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net"><code>URI</code></a>, 2) make sure that it has an XML node addressed by
 <code>"//data"</code> XPath, 3) retrieve all nodes by that XPath, and
 4) use the first element in the found collection of texts. But, before
 doing all this a <code>retryOnFailure</code> assertion policy will be used:

 <pre> AssertionPolicy retryOnFailure = new AssertionPolicy() {
   private boolean valid;
   &#64;Override
   public void assertThat(TestResponse response) {
     if (response.getStatus() != HttpURLConnection.HTTP_OK) {
       throw new AssertionError("invalid HTTP status, will try again");
     }
     this.valid = true;
   }
   &#64;Override
   public boolean isRetryNeeded(int attempt) {
     return !this.valid;
   }
 }</pre>

 <p><a href="../../../com/rexsl/test/AssertionPolicy.html#assertThat(com.rexsl.test.TestResponse)"><code>assertThat(TestResponse)</code></a> will be called right
 after the document is retrieved from the server. Actually, it will be called
 even earlier, even before the HTTP request is made. In the example above
 the request will be made inside <code>response.getStatus()</code>. If it will
 fail for some reason (host not found, for example) - an exception will be
 thrown and <code>this.valid</code> will stay in <code>FALSE</code> status. Thus, it
 is a bullet-proof design, where you can control everything, including
 network errors.

 <p>Implementation of this interface need NOT be thread-safe.</div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>0.3.4</dd>
<dt><span class="strong">Version:</span></dt>
  <dd>$Id$</dd>
<dt><span class="strong">Author:</span></dt>
  <dd>Yegor Bugayenko (yegor@tpc2.com)</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../com/rexsl/test/AssertionPolicy.Quiet.html" title="annotation in com.rexsl.test">AssertionPolicy.Quiet</a></strong></code>
<div class="block">Annotates a policy that should not produce a full exception trace
 in log if it fails.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../com/rexsl/test/AssertionPolicy.html#assertThat(com.rexsl.test.TestResponse)">assertThat</a></strong>(<a href="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test">TestResponse</a>&nbsp;response)</code>
<div class="block">Make an assertion and return nothing or throw <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/AssertionError.html?is-external=true" title="class or interface in java.lang"><code>AssertionError</code></a>
 if some problem is found.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../com/rexsl/test/AssertionPolicy.html#isRetryNeeded(int)">isRetryNeeded</a></strong>(int&nbsp;attempt)</code>
<div class="block">Do we need to re-fetch the page and try again?</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="assertThat(com.rexsl.test.TestResponse)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assertThat</h4>
<pre>void&nbsp;assertThat(<a href="http://download.oracle.com/javaee/6/api/javax/validation/constraints/NotNull.html?is-external=true" title="class or interface in javax.validation.constraints">@NotNull</a>
              <a href="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test">TestResponse</a>&nbsp;response)</pre>
<div class="block">Make an assertion and return nothing or throw <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/AssertionError.html?is-external=true" title="class or interface in java.lang"><code>AssertionError</code></a>
 if some problem is found.

 <p>Validity information about the response should be collected in
 this method and stored in the object's variable. Later you should use
 it in <a href="../../../com/rexsl/test/AssertionPolicy.html#isRetryNeeded(int)"><code>isRetryNeeded(int)</code></a> in order to inform
 the caller of whether it
 should retry the request or not.

 <p>If the method doesn't throw <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/AssertionError.html?is-external=true" title="class or interface in java.lang"><code>AssertionError</code></a> it means that
 everything went fine and <a href="../../../com/rexsl/test/AssertionPolicy.html#isRetryNeeded(int)"><code>isRetryNeeded(int)</code></a> will
 never be called.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>response</code> - The response to assert</dd></dl>
</li>
</ul>
<a name="isRetryNeeded(int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isRetryNeeded</h4>
<pre>boolean&nbsp;isRetryNeeded(int&nbsp;attempt)</pre>
<div class="block">Do we need to re-fetch the page and try again?

 <p>This method is called by
 <a href="../../../com/rexsl/test/TestResponse.html#assertThat(com.rexsl.test.AssertionPolicy)"><code>TestResponse.assertThat(AssertionPolicy)</code></a> before the next
 attempt, in order to check whether it is required. <a href="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><code>TestResponse</code></a>
 keeps track of attempts (so you don't have to do it here) and will stop
 making them after <a href="../../../com/rexsl/test/TestResponse.html#MAX_ATTEMPTS"><code>TestResponse.MAX_ATTEMPTS</code></a>. In most cases
 you don't need to store this attempt number locally.
 If <code>retryAgain()</code> returns <code>TRUE</code> <a href="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><code>TestResponse</code></a>
 will try again, otherwise it will throw an exception.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>attempt</code> - Number of attempt we're trying to make (will not ask for
  attempt #0, but will start from #1)</dd>
<dt><span class="strong">Returns:</span></dt><dd>Yes, we should try again (if <code>TRUE</code>)</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AssertionPolicy.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../com/rexsl/test/AssertionPolicy.Quiet.html" title="annotation in com.rexsl.test"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/rexsl/test/AssertionPolicy.html" target="_top">Frames</a></li>
<li><a href="AssertionPolicy.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2011&#x2013;2013 <a href="http://www.rexsl.com">ReXSL.com</a>. All rights reserved.</small></p>
</body>
</html>
