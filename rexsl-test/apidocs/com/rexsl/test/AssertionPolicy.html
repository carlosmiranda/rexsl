<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_23) on Sun Jun 03 13:02:19 UTC 2012 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
AssertionPolicy (rexsl-test 1.0-SNAPSHOT API)
</TITLE>

<META NAME="date" CONTENT="2012-06-03">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AssertionPolicy (rexsl-test 1.0-SNAPSHOT API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/AssertionPolicy.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../com/rexsl/test/JaxbConverter.html" title="class in com.rexsl.test"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?com/rexsl/test/AssertionPolicy.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AssertionPolicy.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.rexsl.test</FONT>
<BR>
Interface AssertionPolicy</H2>
<DL>
<DT><B>All Known Implementing Classes:</B> <DD><A HREF="../../../com/rexsl/test/assertions/BodyMatcher.html" title="class in com.rexsl.test.assertions">BodyMatcher</A>, <A HREF="../../../com/rexsl/test/assertions/Failure.html" title="class in com.rexsl.test.assertions">Failure</A>, <A HREF="../../../com/rexsl/test/assertions/HeaderMatcher.html" title="class in com.rexsl.test.assertions">HeaderMatcher</A>, <A HREF="../../../com/rexsl/test/assertions/StatusMatcher.html" title="class in com.rexsl.test.assertions">StatusMatcher</A>, <A HREF="../../../com/rexsl/test/assertions/XpathMatcher.html" title="class in com.rexsl.test.assertions">XpathMatcher</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public interface <B>AssertionPolicy</B></DL>
</PRE>

<P>
Policy of assertion, used by <A HREF="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><CODE>TestResponse</CODE></A>.

 <p>Assertion policy is used in <A HREF="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><CODE>TestResponse</CODE></A> in order to validate
 REST response before further processing. Consider this example:

 <pre>
 String data = RestTester.start(new URI("http://example.com"))
   .assertThat(retryOnFailure)
   .assertXPath("//data")
   .xpath("//data/text()")
   .get(0);
 </pre>

 <p>This code will 1) retrieve the document from the provided
 <A HREF="http://download.oracle.com/javase/6/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net"><CODE>URI</CODE></A>, 2) make sure that it has an XML node addressed by
 <code>"//data"</code> XPath, 3) retrieve all nodes by that XPath, and
 4) use the first element in the found collection of texts. But, before
 doing all this a <code>retryOnFailure</code> assertion policy will be used:

 <pre>
 AssertionPolicy retryOnFailure = new AssertionPolicy() {
   private boolean valid;
   &#64;Override
   public void assertThat(TestResponse response) {
     if (response.getStatus() != HttpURLConnection.HTTP_OK) {
       throw new AssertionError("invalid HTTP status, will try again");
     }
     this.valid = true;
   }
   &#64;Override
   public boolean isRetryNeeded(int attempt) {
     return !this.valid;
   }
 }
 </pre>

 <p><A HREF="../../../com/rexsl/test/AssertionPolicy.html#assertThat(com.rexsl.test.TestResponse)"><CODE>assertThat(TestResponse)</CODE></A> will be called right
 after the document is retrieved from the server. Actually, it will be called
 even earlier, even before the HTTP request is made. In the example above
 the request will be made inside <code>response.getStatus()</code>. If it will
 fail for some reason (host not found, for example) - an exception will be
 thrown and <code>this.valid</code> will stay in <code>FALSE</code> status. Thus, it
 is a bullet-proof design, where you can control everything, including
 network errors.

 <p>Implementation of this interface need NOT be thread-safe.
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>0.3.4</DD>
<DT><B>Version:</B></DT>
  <DD>$Id: AssertionPolicy.java 1758 2012-05-28 14:51:16Z guard $</DD>
<DT><B>Author:</B></DT>
  <DD>Yegor Bugayenko (yegor@rexsl.com)</DD>
</DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/rexsl/test/AssertionPolicy.html#assertThat(com.rexsl.test.TestResponse)">assertThat</A></B>(<A HREF="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test">TestResponse</A>&nbsp;response)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Make an assertion and return nothing or throw <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/AssertionError.html?is-external=true" title="class or interface in java.lang"><CODE>AssertionError</CODE></A>
 if some problem is found.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/rexsl/test/AssertionPolicy.html#isRetryNeeded(int)">isRetryNeeded</A></B>(int&nbsp;attempt)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Do we need to re-fetch the page and try again?</TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="assertThat(com.rexsl.test.TestResponse)"><!-- --></A><H3>
assertThat</H3>
<PRE>
void <B>assertThat</B>(<FONT SIZE="-1"><A HREF="http://download.oracle.com/javaee/6/api/javax/validation/constraints/NotNull.html?is-external=true" title="class or interface in javax.validation.constraints">@NotNull</A></FONT>
                <A HREF="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test">TestResponse</A>&nbsp;response)</PRE>
<DL>
<DD>Make an assertion and return nothing or throw <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/AssertionError.html?is-external=true" title="class or interface in java.lang"><CODE>AssertionError</CODE></A>
 if some problem is found.

 <p>Validity information about the response should be collected in
 this method and stored in the object's variable. Later you should use
 it in <A HREF="../../../com/rexsl/test/AssertionPolicy.html#isRetryNeeded(int)"><CODE>isRetryNeeded(int)</CODE></A> in order to inform
 the caller of whether it
 should retry the request or not.

 <p>If the method doesn't throw <A HREF="http://download.oracle.com/javase/6/docs/api/java/lang/AssertionError.html?is-external=true" title="class or interface in java.lang"><CODE>AssertionError</CODE></A> it means that
 everything went fine and <A HREF="../../../com/rexsl/test/AssertionPolicy.html#isRetryNeeded(int)"><CODE>isRetryNeeded(int)</CODE></A> will
 never be called.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>response</CODE> - The response to assert</DL>
</DD>
</DL>
<HR>

<A NAME="isRetryNeeded(int)"><!-- --></A><H3>
isRetryNeeded</H3>
<PRE>
boolean <B>isRetryNeeded</B>(int&nbsp;attempt)</PRE>
<DL>
<DD>Do we need to re-fetch the page and try again?

 <p>This method is called by
 <A HREF="../../../com/rexsl/test/TestResponse.html#assertThat(com.rexsl.test.AssertionPolicy)"><CODE>TestResponse.assertThat(AssertionPolicy)</CODE></A> before the next
 attempt, in order to check whether it is required. <A HREF="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><CODE>TestResponse</CODE></A>
 keeps track of attempts (so you don't have to do it here) and will stop
 making them after <A HREF="../../../com/rexsl/test/TestResponse.html#MAX_ATTEMPTS"><CODE>TestResponse.MAX_ATTEMPTS</CODE></A>. In most cases
 you don't need to store this attempt number locally.
 If <code>retryAgain()</code> returns <code>TRUE</code> <A HREF="../../../com/rexsl/test/TestResponse.html" title="interface in com.rexsl.test"><CODE>TestResponse</CODE></A>
 will try again, otherwise it will throw an exception.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>attempt</CODE> - Number of attempt we're trying to make (will not ask for
  attempt #0, but will start from #1)
<DT><B>Returns:</B><DD>Yes, we should try again (if <code>TRUE</code>)</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/AssertionPolicy.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../com/rexsl/test/JaxbConverter.html" title="class in com.rexsl.test"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?com/rexsl/test/AssertionPolicy.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="AssertionPolicy.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2011-2012 <a href="http://www.rexsl.com">ReXSL.com</a>. All Rights Reserved.
</BODY>
</HTML>
